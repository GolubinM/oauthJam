const a1=b;(function(c,d){const a0=b,e=c();while(!![]){try{const f=parseInt(a0(0x25b))/0x1+parseInt(a0(0x2e2))/0x2*(-parseInt(a0(0x31e))/0x3)+parseInt(a0(0x316))/0x4*(parseInt(a0(0x1f8))/0x5)+-parseInt(a0(0x227))/0x6*(-parseInt(a0(0x2cc))/0x7)+parseInt(a0(0x202))/0x8*(parseInt(a0(0x1ab))/0x9)+-parseInt(a0(0x1c8))/0xa+-parseInt(a0(0x2da))/0xb*(parseInt(a0(0x1fc))/0xc);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x3a828));var SS=SpreadsheetApp[a1(0x31b)](),SSId=SS['getId'](),SheetNames={'products':a1(0x1ce),'advList':'РК','advStat':a1(0x32d),'keyWords':a1(0x1f0),'analyticsJam':a1(0x2c6),'searchJam':a1(0x1ff),'analyticNmIdPeriod':'analyticsPeriod','searchTextsJam':'searchText','advHistory':'История\x20затрат(api)'};function getProducts(){const a2=a1;checkAccess_();let c=[],d,f;const g={'Authorization':getkey('stand')};let h=ApiUtils[a2(0x235)](SSId,SheetNames[a2(0x270)]+a2(0x21b)),i=h?.['length'],j=i?h[a2(0x2fd)](0x1)[a2(0x24a)](s=>s[0x0]):[],k=new Set(j);r();let l,m,n=0x64,o=[],p=0x1;while(p<0xc8){l=UrlFetchApp[a2(0x1e4)](a2(0x299),f),SysUtils/SysUtils[a2(0x32a)](l[a2(0x21a)]()),m=JSON[a2(0x24f)](l[a2(0x271)]()),o=o[a2(0x2dd)](m?.[a2(0x251)]),n=m?.['cursor']?.[a2(0x209)]||0x0;if(n<0x64)break;r(m?.[a2(0x2f0)]),p++,Utilities[a2(0x207)](0x190);}o?.['length']&&(c=o[a2(0x1ea)]((s,t)=>{const a3=a2;let u=parseInt(t[a3(0x292)],0xa);return!k[a3(0x2a9)](u)&&s[a3(0x1d2)]([u,t['vendorCode']]),s;},[]));c?.['length']&&(h[a2(0x1d2)](...c),i==0x0&&h[a2(0x336)]([a2(0x25a),a2(0x292)]),ApiUtils['writeToSS'](SSId,h,SheetNames['products']+'!A1','RAW'));let q=a2(0x23d)+c[a2(0x2e0)];try{inform(SS,[q,''+SheetNames['products']]);}catch(s){}function r(t=''){const a4=a2;let u={'cursor':{'limit':0x64},'filter':{'withPhoto':-0x1},'sort':{'ascending':!![]}};t&&(u[a4(0x2f0)][a4(0x1df)]=t[a4(0x1df)],u[a4(0x2f0)]['nmID']=t[a4(0x292)]),d={'settings':u},f={'headers':g,'method':'post','contentType':a4(0x27d),'payload':JSON[a4(0x1d4)](d),'muteHttpExceptions':!![]};}}function getAdvStatistic(){const a5=a1;checkAccess_();let c='',{dateFromSer:d,dateToSer:f}=getHeaderDateParams(SheetNames[a5(0x2f5)]);f-d>0x1f&&(c=a5(0x298),inform(SS,[c,SheetNames[a5(0x2f5)]]),d=f-0x1f);let g=DateUtils[a5(0x33b)](d),h=DateUtils[a5(0x33b)](f);console['log'](a5(0x1f9)+(f-d)+a5(0x2b0)+g+'\x20по:\x20'+h);let i=getkey(a5(0x262)),j=ApiUtils[a5(0x235)](SSId,SheetNames[a5(0x28e)]+a5(0x240),'UNFORMATTED_VALUE',a5(0x221)),k={};j=j['reduce']((D,E)=>{return(E[0x2]==0x9||E[0x2]==0xb||E[0x3]>=d)&&(k[E[0x0]]=E[0x1],D['push'](E[0x0])),D;},[]),j=[...new Set(j)],j['sort']((D,E)=>E-D),console['info']('всего\x20кампаний:\x20'+j[a5(0x2e0)]),console[a5(0x2a5)](a5(0x353)+j);let l=0x0,m=0x5f,n=[];const o={'Authorization':i};while(l<j[a5(0x2e0)]){n[a5(0x1d2)](j[a5(0x2fd)](l,l+m)),l+=m;}let p=n[a5(0x24a)](D=>{const a6=a5;let E=D[a6(0x24a)](G=>{return{'id':G,'interval':{'begin':g,'end':h}};}),F={'url':a6(0x1aa),'options':{'method':a6(0x266),'payload':JSON[a6(0x1d4)](E),'headers':o,'muteHttpExceptions':!![]}};return F;});console[a5(0x2a5)](a5(0x297),p[a5(0x2e0)],a5(0x252),m);let q=0x0,r=0x3,s=0xfde8,t=[],u,v=0x0,w,x=0x1,y=[],z=0x0;for(let D of p){!x&&v>0x0&&Utilities[a5(0x207)](v);while(q<r){if(B(D,z)){v=u+s-Date[a5(0x2bd)](),z++;break;}v=w?w*0x3e8:s,console[a5(0x25d)](a5(0x26c)+z+a5(0x29c)+q+a5(0x1ac)+v/0x3e8),q++,!x&&v>0x0&&Utilities[a5(0x207)](v);}}q===r&&console[a5(0x25d)](a5(0x237)+z+'\x20не\x20был\x20обработан\x20корректно.');C(y),console[a5(0x25d)](c);let A=0x1*0xea60;removeTriggers([a5(0x1e6)]),ScriptApp[a5(0x329)](a5(0x1e6))[a5(0x22e)]()[a5(0x2f9)](A)[a5(0x263)](),c+=a5(0x1a9);try{inform(SS,[c,SheetNames[a5(0x2f5)]]);}catch(E){}function B(F,G){const a7=a5;w=0x0;let H=UrlFetchApp[a7(0x1e4)](F[a7(0x1e0)],F[a7(0x32b)]);u=Date[a7(0x2bd)](),Utilities['sleep'](0x1388);let I=H[a7(0x21a)](),J=H[a7(0x1b1)]();x=+J[a7(0x244)]||0x0,console['log']('Запрос\x20'+G+':\x20code\x20'+I+a7(0x1db)+x+'\x20'+(c=I==0x190?result['value']?.[a7(0x2d6)]:'')+'.');c&&inform(SS,[c,a7(0x250)]);if(I===0x1ad)w=J[a7(0x2b6)],console[a7(0x25d)](I,a7(0x2fe)+G+a7(0x2a8)+w);else{if(I===0xc8)return y['push'](H[a7(0x271)]()),!![];}return![];}function C(F){const a8=a5;t=F[a8(0x1ea)]((G,H)=>{const a9=a8;let I,J=[];return I=JSON[a9(0x24f)](H),I?.[a9(0x2e0)]&&I['forEach'](function(K){const aa=a9;for(let L of K?.['days']){for(let M of L?.[aa(0x2e6)]){if(M?.['appType'])for(let N of M?.['nm']){J[aa(0x1d2)]([Math[aa(0x217)](DateUtils[aa(0x24d)](new Date(L?.['date'])))||'',K?.[aa(0x225)]||'',N?.[aa(0x358)]||'',+N?.[aa(0x291)]||'',N?.[aa(0x27a)]||'',N?.['views']||'',N?.[aa(0x288)]||'',N?.[aa(0x346)]||'','','','',N?.['atbs']||'',N?.['orders']||'',+N?.['cr']||'',N?.[aa(0x23f)]||'',N?.[aa(0x23e)]||'',k[''+K?.[aa(0x225)]]||'']);}}}}),J[a9(0x2e0)]&&(G=G[a9(0x2dd)](J)),G;},[]);if(t[a8(0x2e0)]){console[a8(0x25d)](a8(0x301)),t=SheetUtils[a8(0x2ff)](t,[0x0,0x1,0x2,0x10],[0x3,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf]),t=getHystorySpentForAdv(t);const G=DateUtils[a8(0x1bf)](d,SheetNames['advStat']+a8(0x2be))+0x5;t['sort']((K,L)=>K[0x0]-L[0x0]),tableLength=t[a8(0x2e0)];const H=SS['getSheetByName'](SheetNames['advStat'])[a8(0x1b2)](),I=t[a8(0x2e0)]-H+G-0x1;I>0x0&&(t=SheetUtils[a8(0x200)](t,I));let J=ApiUtils[a8(0x28a)](SSId,t,SheetNames[a8(0x2f5)]+'!A'+G);J&&(c+=a8(0x2f6)+tableLength);}else c+='Данные\x20для\x20обновления\x20не\x20были\x20получены.';}}function getHystorySpentForAdv(c){const ab=a1;let d=c[ab(0x1ea)]((g,h)=>{const ac=ab;let j=h[0x0]+'~'+h[0x1];return g[j]=g[j]||{'total':0x0},g[j][ac(0x209)]+=h[0x3],g;},{}),e=ApiUtils['readRangeSS'](SSId,SheetNames['advHistory']+ab(0x2c4),ab(0x27f),ab(0x221)),f=e[ab(0x1ea)]((g,h)=>{const ad=ab;let j=h[0x0]+'~'+h[0x1];return g[j]=g[j]||{'total':0x0},g[j][ad(0x209)]+=h[0x2],g;},{});for(let g=0x0;g<c[ab(0x2e0)];g++){let h=c[g][0x0]+'~'+c[g][0x1],j=d[h]?c[g][0x3]/d[h][ab(0x209)]:0x0,k=f[h]?j*f[h][ab(0x209)]:0x0;c[g][ab(0x1d2)](k);}return c;}function updateHistory(){const ae=a1;checkAccess_();let {dateFromSer:c,dateToSer:d}=getHeaderDateParams(SheetNames[ae(0x28c)]),e=d-c+0x1,f=SS[ae(0x212)](SheetNames[ae(0x28c)]);SheetUtils[ae(0x1ba)](f);let g=[];const h=DateUtils[ae(0x2d5)](e,d+0x1);h['forEach'](m=>{const af=ae;let n=l(m[af(0x315)],m[af(0x21c)]);n[af(0x2e0)]&&(n=SheetUtils[af(0x2ff)](n,[0x0,0x1,0x3,0x4,0x5],[0x2]),g=g[af(0x2dd)](n));}),g['sort']((m,n)=>DateUtils['reversDateStToSort'](m[0x0])['localeCompare'](DateUtils['reversDateStToSort'](n[0x0])));let i=DateUtils[ae(0x1bf)](c,SheetNames[ae(0x28c)]+ae(0x2be))+0x5;lastRow=SS[ae(0x212)](SheetNames['advHistory'])[ae(0x1b2)]();let j=lastRow-(i+g[ae(0x2e0)]-0x1);j>0x0&&(g=SheetUtils[ae(0x200)](g,j));ApiUtils[ae(0x28a)](SSId,g,SheetNames[ae(0x28c)]+'!A'+i);let k=ae(0x208)+g[ae(0x2e0)]+ae(0x2d3)+i;inform(SS,[k,SheetNames[ae(0x28c)]]);function l(m,n){const ag=ae;let o='https://advert-api.wildberries.ru/adv/v1/upd?from='+m+ag(0x311)+n;console['log'](ag(0x2c9)+m+'\x20to='+n+'.');let p={'method':ag(0x352),'contentType':ag(0x27d),'muteHttpExceptions':!![],'headers':{'Authorization':getkey(ag(0x262))}};try{let q=UrlFetchApp[ag(0x1e4)](o,p);return Utilities['sleep'](0x3e8),q=JSON[ag(0x24f)](q),q=q['reduce']((r,s)=>{const ah=ag;return s[ah(0x35b)][ah(0x2fd)](0x0,0xa)>m&&s[ah(0x35b)]['slice'](0x0,0xa)<=n&&r['push']([s[ah(0x35b)]?DateUtils[ah(0x2a0)](s[ah(0x35b)]):ah(0x1e1),s[ah(0x225)]||'',s[ah(0x348)]||'',s['advertType']||'',s[ah(0x255)]||'',s[ah(0x30e)]||'']),r;},[]),q;}catch(r){console[ag(0x25d)](ag(0x314),r[ag(0x356)]);}}}function getAdvCampList(){const ai=a1;checkAccess_();let c=SS['getSheetByName'](SheetNames[ai(0x28e)]);SheetUtils[ai(0x1ba)](c);let d='https://advert-api.wildberries.ru/adv/v1/promotion/count',f={'method':ai(0x352),'contentType':'application/json','muteHttpExceptions':!![],'headers':{'Authorization':getkey(ai(0x262))}},g,h;try{g=UrlFetchApp['fetch'](d,f);if(g[ai(0x21a)]()===0xc8){g=JSON[ai(0x24f)](g);let l=j(g[ai(0x236)]),m=ApiUtils['readRangeSS'](SS[ai(0x2ce)](),SheetNames[ai(0x28e)]+'!A2:D',ai(0x27f),'SERIAL_NUMBER');const n=m[ai(0x2e0)];let o=m['reduce']((r,s)=>{return r[s[0x0]]=s,r;},{});o=Object['assign'](o,l);let p=Object[ai(0x1f3)](o);p=k(p,f),h=p[ai(0x2e0)];const q=n-h;q>0x0&&(p=SheetUtils[ai(0x200)](p,q)),ApiUtils[ai(0x28a)](SSId,p,SheetNames['advList']+'!A2'),c[ai(0x2d9)]('E2:E')[ai(0x23b)]('dd.MM.yyyy\x20H:mm:ss');}}catch(r){console[ai(0x25d)](r);}let i=ai(0x308)+h;inform(SS,[i,ai(0x278)]);try{inform(SS,[i,''+SheetNames[ai(0x28e)]]);}catch(s){}function j(t){const u=t['reduce']((v,w)=>{const aj=b;return w['advert_list'][aj(0x31f)](x=>{const ak=aj;v[x[ak(0x225)]]=[x[ak(0x225)],w[ak(0x290)],w['status'],DateUtils['getSerialNumberDate'](new Date(x[ak(0x2c2)]))];}),v;},{});return u;}function k(t,u){const al=ai;let v=t[al(0x24a)](z=>z[0x0]),w=SysUtils['pagination'](v,0x32);console[al(0x25d)](al(0x20f)+w[al(0x2e0)]);let x=al(0x1b6);u[al(0x1ec)]=al(0x266);let y=w['reduce']((z,A,B)=>{const am=al;u[am(0x285)]=JSON['stringify'](A);try{B&&Utilities[am(0x207)](0x12c);let C=UrlFetchApp['fetch'](x,u);if(C[am(0x21a)]()===0xc8){C=JSON['parse'](C);let D=C['reduce']((E,F)=>{const an=am;return E[F[an(0x225)]]='\x27'+F?.[an(0x27a)]||'',E;},{});Object['assign'](z,D);}else throw new Error(am(0x1d6));}catch(E){console['log'](E[am(0x356)]),am(0x242)+g['getResponseCode']()+am(0x27b)+B;}return z;},{});return t[al(0x31f)](z=>{const ao=al;let A=y[z[0x0]];z[ao(0x1ad)](0x1,0x0,A);}),t;}}function statKeyWords(c){const ap=a1;checkAccess_(),removeTriggers([ap(0x1e6)]);let {dateFromSer:d,dateToSer:f}=getHeaderDateParams(SheetNames[ap(0x2f5)]);console[ap(0x25d)](ap(0x277),d,f);let g='',h;const i=0x12c,j={'Authorization':getkey(ap(0x262))};console[ap(0x25d)](ap(0x2d7)+SS['getName']()+'\x20spreadsheet.');let k=ApiUtils['readRangeSS'](SSId,SheetNames[ap(0x2f5)]+ap(0x1d0),ap(0x27f),ap(0x221)),{maxDateStatAB:l,minDateStatAB:m}=k['reduce']((H,I)=>{const aq=ap;if(I[0x0]>H[aq(0x1d7)])H[aq(0x1d7)]=I[0x0];if(I[0x0]<H['minDateStatAB'])H[aq(0x2bb)]=I[0x0];return H;},{'maxDateStatAB':-Infinity,'minDateStatAB':Infinity});f=Math[ap(0x33c)](f,l),d=Math[ap(0x30f)](d,m),console['log'](ap(0x1c4)+DateUtils[ap(0x33b)](d)+ap(0x267)+DateUtils['getStrDateFromSerialNumberDate'](f));let n=new Set(),o=ApiUtils[ap(0x235)](SSId,SheetNames['advList']+ap(0x240),ap(0x27f),'SERIAL_NUMBER');o['forEach'](H=>{const ar=ap;H[0x2]==0x8&&n[ar(0x1de)](H[0x0]);});let p=0x6,q=f,r=[];while(d<q){f=Math[ap(0x33c)](d+p,q),r['push']({'from':d,'to':f}),d=f;}let s=[],t=new Set(),u=r[ap(0x1ea)]((H,I)=>{const at=ap;let J=new Set();k['forEach']((M,N)=>{const as=b;M[0x0]>=I[as(0x2df)]&&M[0x0]<=I['to']&&n['has'](M[0x1])&&(J[as(0x1de)](M[0x1]),t[as(0x1de)](N));});let K=DateUtils['getStrDateFromSerialNumberDate'](I['from']),L=DateUtils['getStrDateFromSerialNumberDate'](I['to']);return J[at(0x31f)](M=>{const au=at;s[au(0x1d2)](M),H[au(0x1d2)]({'url':'https://advert-api.wildberries.ru/adv/v0/stats/keywords?advert_id='+M+'&from='+K+au(0x311)+L,'options':{'method':'GET','headers':j,'contentType':'application/json','muteHttpExceptions':!![]}});}),H;},[]),v=u[ap(0x2e0)];console[ap(0x2a5)](ap(0x2e1),v);let w=+(c['getProperty'](ap(0x1e3))||0x0);w?console[ap(0x25d)](ap(0x284)+w*i):console['log'](ap(0x357)+i);let x=w*i,y=(w+0x1)*i;u=u[ap(0x2fd)](x,y);let z=0x0,A=0x6,B=[],C=0x0,D=0x0;for(let H of u){let I=null;C++;!(C%0x1e)&&console[ap(0x25d)](ap(0x302),C);while(z<A){try{let J=UrlFetchApp[ap(0x1e4)](H[ap(0x1e0)],H[ap(0x32b)]);Utilities[ap(0x207)](0x190),I=J[ap(0x21a)]();if(I==0xc8){B[ap(0x1d2)](J[ap(0x271)]());break;}else I>=0x1ad?(console[ap(0x25d)](C,ap(0x2b4),I,'waitng\x20for\x201s.'),Utilities[ap(0x207)](0x3e8)):(console['log'](C,'\x20code:',I,'skip\x20request.'),z=A);}catch(K){console[ap(0x25d)]('Ошибка\x20при\x20выполнении\x20запроса:'),console[ap(0x25d)](K[ap(0x26b)]);}z++;}z===A&&console[ap(0x28d)](ap(0x24b)+C+'\x20не\x20был\x20получен.\x20Код:',I);}w++;let E=![],F;v>w*i?(F=ap(0x24c)+w*i,c[ap(0x20b)](ap(0x1e3),w),ScriptApp[ap(0x329)](ap(0x1e6))[ap(0x22e)]()[ap(0x2f9)](0xea60)[ap(0x263)]()):(F=ap(0x2cb),c[ap(0x2d8)](ap(0x1e3)),E=!![]);G(B,E);try{inform(SS,[F,ap(0x1e3)]);}catch(L){}console['log'](ap(0x33e));function G(M,N){const av=ap;console[av(0x25d)]('Ответ\x20получен.\x20Парсинг.');let O=M['reduce']((P,Q,R)=>{const aw=av;let S=JSON[aw(0x24f)](Q)?.[aw(0x1f0)]||[],T=S['reduce']((U,V)=>{const ax=aw;let W=V[ax(0x304)][ax(0x1ea)]((Y,Z)=>{const ay=ax;return Y['clicks']+=Z[ay(0x288)],Y[ay(0x291)]+=Z[ay(0x291)],Y['views']+=Z[ay(0x2c7)],Y;},{'clicks':0x0,'sum':0x0,'views':0x0});W['advId']=s[R],W['serKwDate']=DateUtils[ax(0x275)](new Date(V[ax(0x274)]));let X=W[ax(0x214)]+'~'+W['serKwDate'];return U[X]=W,U;},{});return Object[aw(0x256)](P,T),P;},{});if(N){O=saveAndReadDataToJSON_(O,av(0x29f)+SSId[av(0x2fd)](-0x6),save=![]),console['log'](av(0x206),Object[av(0x318)](O)['length']);if(Object['keys'](O)[av(0x2e0)]){h=k['map']((Q,R)=>{const az=av;if(t[az(0x2a9)](R)){let S=Q[0x1]+'~'+Q[0x0];if(O[S]){let {clicks:T,sum:U,views:V}=O[S];return delete O[S],[T,U,V];}}return[null,null,null];});let P=ApiUtils['writeToSS'](SSId,h,SheetNames[av(0x2f5)]+av(0x23c));P&&(g+=av(0x22d));}else g+='Данные\x20для\x20обновления\x20не\x20были\x20получены.';}else Object[av(0x318)](O)[av(0x2e0)]?(saveAndReadDataToJSON_(O,av(0x29f)+SSId[av(0x2fd)](-0x6),save=!![]),g+=av(0x34d)+Object[av(0x318)](O)[av(0x2e0)]):g+=av(0x1c3);console['log'](g),inform(SS,[g,av(0x1f7)]);}}function analyticNmIdPeriod(c){const aA=a1;checkAccess_(),removeTriggers([aA(0x20c)]);let {dateFromSer:d,dateToSer:e}=getHeaderDateParams(SheetNames[aA(0x1e5)]);const f=0xe;console['log'](aA(0x2de)+SS['getName']()+'\x20spreadsheet.');const g={'Authorization':getkey('rekl')};let h=[],i=0x0;console[aA(0x25d)](aA(0x2a2)+DateUtils['getStrDateFromSerialNumberDate'](d)+aA(0x267)+DateUtils['getStrDateFromSerialNumberDate'](e));let j=ApiUtils[aA(0x235)](SSId,SheetNames[aA(0x270)]+aA(0x30b),'UNFORMATTED_VALUE',aA(0x221));j=j[aA(0x1ea)]((D,E)=>{return E[0x0]&&E[0x2]&&D['push'](E[0x0]),D;},[]),console[aA(0x25d)](aA(0x1fe),j);let k={'timezone':'Europe/Moscow','orderBy':{'field':'ordersSumRub','mode':aA(0x2f4)},'page':0x1},l=0x2,m=[],n;e--;let o=DateUtils[aA(0x24d)](new Date());while(e-d>-0x1){let D=DateUtils[aA(0x310)](e),E=DateUtils[aA(0x310)](Math[aA(0x33c)](e+0x1-0x1/0x5265c00,o));m[aA(0x1d2)]({'begin':D,'end':E}),e-=l;}console[aA(0x25d)]('Периоды\x20сбора\x20данных:',m);let p,q,r=0x3,s=0x5208,t=[],u,v=0x0,w,x=0x1,y=m[aA(0x2e0)];if(y){let F=m[aA(0x24a)](G=>{const aB=aA;return k[aB(0x29d)]=G,{'url':'https://seller-analytics-api.wildberries.ru/api/v2/nm-report/detail','options':{'method':aB(0x266),'headers':g,'payload':JSON[aB(0x1d4)](k),'contentType':aB(0x27d),'muteHttpExceptions':!![]}};});console[aA(0x25d)](aA(0x335)+F[aA(0x2e0)]+'.\x20Максимум\x20запросов\x20за\x205\x20мин:\x2015.'),q=+(c[aA(0x321)](aA(0x1e5))||0x0);q?console[aA(0x25d)](aA(0x1bc)+q*f):console[aA(0x25d)](aA(0x219));F=F[aA(0x2fd)](q*f,(q+0x1)*f),console[aA(0x25d)](aA(0x2dc)+F[aA(0x2e0)]+aA(0x1eb));for(let G of F){console[aA(0x25d)]('Before\x20request:\x20xRatelimitRemaining\x20&&\x20waitFor:'+x+',\x20'+v);!x&&v>0x0&&Utilities[aA(0x207)](v);p=0x0;while(p<r){let H=B(G,i);if(H===0x0){v=u+s-Date[aA(0x2bd)](),i++;break;}else{if(H===-0x1)console[aA(0x25d)]('Запрос\x20с\x20кодом!=200:\x20'+i+aA(0x29c)+p+aA(0x1ac)+v/0x3e8),p++;else H>0x1&&(console[aA(0x25d)](aA(0x323)+H),G['options']['payload'][aA(0x2ed)]=H,p+=0.5);}v=w?(w+0x1)*0x3e8:s,!x&&v>0x0&&Utilities[aA(0x207)](v);}}p===r&&console['log']('Запрос\x20'+i+'\x20не\x20был\x20обработан\x20корректно.\x20Превышен\x20лимит\x20запросов.'),console[aA(0x25d)](aA(0x201)),console[aA(0x25d)](h['length']),n=C(h);}else n=aA(0x2bc);q++;let z=q*f,A=z<y?!![]:![];A?(console[aA(0x25d)](aA(0x1fa),q),c[aA(0x20b)](aA(0x1e5),q),ScriptApp[aA(0x329)](aA(0x20c))[aA(0x22e)]()['after'](0xea60)[aA(0x263)]()):c[aA(0x2d8)](aA(0x1e5));console['log'](n),console[aA(0x25d)](aA(0x234));function B(I,J){const aC=aA;console[aC(0x25d)](aC(0x333),J),w=0x0;let K=UrlFetchApp[aC(0x1e4)](I[aC(0x1e0)],I[aC(0x32b)]);u=Date[aC(0x2bd)](),Utilities[aC(0x207)](0x1f4);let L=K[aC(0x21a)](),M=K[aC(0x1b1)]();x=+(M[aC(0x244)]||0x0),console['log'](aC(0x237)+J+':\x20code\x20'+L+aC(0x1db)+x+'\x20'+(message=L==0x190?K['getContentText']():'')+'.');message&&console[aC(0x25d)](message);if(L===0x1ad)w=M[aC(0x2b6)],console['log'](L,aC(0x2fe)+J+',\x20XRatelimitRetry:\x20'+w);else{if(L===0xc8){let N=JSON[aC(0x24f)](K[aC(0x271)]());return h[aC(0x1d2)](N[aC(0x2ee)]),N[aC(0x210)]?N[aC(0x2ed)]+0x1:0x0;}}return-0x1;}function C(I){const aD=aA;t=I[aD(0x1ea)]((J,K)=>{const aE=aD;let L;return Array[aE(0x249)](K[aE(0x251)])&&(L=K[aE(0x251)][aE(0x1ea)]((M,N)=>{const aF=aE;return M[aF(0x1d2)]([N[aF(0x292)],Math[aF(0x217)](DateUtils['getSerialNumberDate'](new Date(N[aF(0x1c9)]['selectedPeriod']['begin']))),N[aF(0x1c9)][aF(0x241)][aF(0x2d1)],N['statistics']['selectedPeriod']['addToCartCount'],N[aF(0x1c9)][aF(0x241)]['ordersCount'],N[aF(0x1c9)]['selectedPeriod'][aF(0x351)],N[aF(0x1c9)]['selectedPeriod'][aF(0x34c)],N[aF(0x1c9)][aF(0x241)][aF(0x1d5)],N[aF(0x1c9)]['selectedPeriod'][aF(0x26f)][aF(0x30d)]/0x64],[N[aF(0x292)],Math[aF(0x217)](DateUtils[aF(0x24d)](new Date(N[aF(0x1c9)]['previousPeriod'][aF(0x2eb)]))),N[aF(0x1c9)]['previousPeriod']['openCardCount'],N['statistics'][aF(0x224)][aF(0x354)],N['statistics']['previousPeriod'][aF(0x258)],N[aF(0x1c9)][aF(0x224)][aF(0x351)],N['statistics'][aF(0x224)]['buyoutsCount'],N['statistics'][aF(0x224)][aF(0x1d5)],N['statistics'][aF(0x224)][aF(0x26f)][aF(0x30d)]/0x64]),M;},[])),J=J[aE(0x2dd)](L),J;},[]);if(t[aD(0x2e0)]){console[aD(0x25d)]('Ответ\x20получен.\x20Парсим.'),n=aD(0x31c)+t[aD(0x2e0)]+'.';let J=ApiUtils[aD(0x235)](SSId,SheetNames['analyticNmIdPeriod']+aD(0x1f2),aD(0x27f),'SERIAL_NUMBER'),K=J[aD(0x1ea)]((O,P)=>{let Q=P[0x0]+'~'+P[0x1];return O[Q]=P,O;},{}),L=t[aD(0x1ea)]((O,P)=>{let Q=P[0x0]+'~'+P[0x1];return O[Q]=P,O;},{});Object['assign'](K,L),t=Object['values'](K),t[aD(0x223)]((O,P)=>O[0x1]-P[0x1]);let M=SS[aD(0x212)](SheetNames[aD(0x1e5)])[aD(0x1b2)]()-0x4,N=M-t[aD(0x2e0)];N>0x0&&(t=SheetUtils[aD(0x200)](t,N)),ApiUtils[aD(0x28a)](SSId,t,SheetNames[aD(0x1e5)]+'!A5');}else n=aD(0x1c3);return n;}}function keyWords(){const aG=a1;checkAccess_();let {dateFromSer:c,dateToSer:d}=getHeaderDateParams(SheetNames[aG(0x260)]),f='';const g=0x64;console[aG(0x25d)](aG(0x2ef)+SS[aG(0x2d4)]()+'\x20spreadsheet.');const h={'Authorization':getkey('rekl')};console['log']('Загрузка\x20данных\x20\x20с\x20'+DateUtils['getStrDateFromSerialNumberDate'](c)+'\x20по\x20'+DateUtils[aG(0x33b)](d));let i=ApiUtils[aG(0x235)](SSId,SheetNames[aG(0x28e)]+'!A2:F','UNFORMATTED_VALUE',aG(0x221));i=i['filter'](w=>w[0x0]&&w[0x5]);i[aG(0x2e0)]>g&&(inform(SS,[aG(0x2aa)+g+aG(0x218)+g+aG(0x341),aG(0x260)]),i=i[aG(0x2fd)](-g));let j=new Set();i[aG(0x31f)](w=>j['add'](w[0x0]));let k=0x6,l=d,m=[];while(c<l){d=Math[aG(0x33c)](c+k,l),m[aG(0x1d2)]({'from':c,'to':d}),c=d;}let n=[],o=m[aG(0x1ea)]((w,x)=>{const aH=aG;let y=DateUtils[aH(0x33b)](x[aH(0x2df)]),z=DateUtils[aH(0x33b)](x['to']);return j[aH(0x31f)](A=>{const aI=aH;n[aI(0x1d2)](A),w[aI(0x1d2)]({'url':aI(0x205)+A+'&from='+y+aI(0x311)+z,'options':{'method':'GET','headers':h,'contentType':aI(0x27d),'muteHttpExceptions':!![]}});}),w;},[]),p=o['length'];console[aG(0x2a5)](aG(0x2e1),p);let q=0x0,r=0x6,s=[],t=0x0;for(let w of o){let x=null;t++;!(t%0x21)&&console['log'](aG(0x302),t);while(q<r){try{let y=UrlFetchApp[aG(0x1e4)](w['url'],w[aG(0x32b)]);Utilities[aG(0x207)](0x190),x=y[aG(0x21a)]();if(x==0xc8){s['push'](y['getContentText']());break;}else x>=0x1ad?(console[aG(0x25d)](t,aG(0x2b4),x,aG(0x34b)),Utilities[aG(0x207)](0x3e8)):(console['log'](t,aG(0x2b4),x,aG(0x21f)),q=r);}catch(z){console['log'](aG(0x319)),console[aG(0x25d)](z['message']);}q++;}q===r&&console[aG(0x28d)]('Ответ\x20на\x20запрос\x20'+t+aG(0x345),x);}let u=aG(0x2cb);v(s);return{'msg':u,'propValue':null,'setTriggFlag':![]};function v(A){const aJ=aG;console[aJ(0x25d)]('Ответ\x20получен.\x20Собрано\x20строк:\x20'+A[aJ(0x2e0)]);let B=A['reduce']((C,D,E)=>{const aK=aJ;let F=JSON[aK(0x24f)](D)?.['keywords']||[],G=F[aK(0x1ea)]((H,I)=>{const aL=aK;serKwDate=DateUtils[aL(0x275)](new Date(I[aL(0x274)])),I[aL(0x304)]=I['stats'][aL(0x223)]((K,L)=>K['views']-L[aL(0x2c7)])[aL(0x2fd)](0x0,0x64);let J=I[aL(0x304)][aL(0x24a)](K=>{const aM=aL;return[serKwDate,n[E],K[aM(0x1ee)],K[aM(0x288)],K['sum'],K['views']];});return H['push'](...J),H;},[]);return C['push'](...G),C;},[]);console[aJ(0x25d)](aJ(0x206),B['length']);if(B[aJ(0x2e0)]){B[aJ(0x223)]((G,H)=>G[0x0]-H[0x0]);let C=[aJ(0x274),'advId',aJ(0x1f0),aJ(0x288),aJ(0x291),aJ(0x2c7)],D=SS[aJ(0x212)](SheetNames[aJ(0x260)])[aJ(0x1b2)]();const E=D-B[aJ(0x2e0)]-0x2;E>0x0&&(B=SheetUtils[aJ(0x200)](B,E));B[aJ(0x336)](C);let F=ApiUtils[aJ(0x28a)](SS[aJ(0x2ce)](),B,SheetNames[aJ(0x260)]+aJ(0x1d8));F&&(f+=aJ(0x22d));}else f+=aJ(0x1c3);inform(SS,[f,SheetNames[aJ(0x260)]]);}}function searchTextsJam(c){const aN=a1;checkAccess_(),removeTriggers(['searchTextsJamTrigg']);let {dateFromSer:d,dateToSer:e}=getHeaderDateParams(SheetNames[aN(0x27c)]);const f=0xa;console[aN(0x25d)]('Start\x20\x22searchTextsJam\x22\x20for\x20'+SS[aN(0x2d4)]()+'\x20spreadsheet.');const g={'Authorization':getkey(aN(0x262))};let h=[],i=0x0;console['log'](aN(0x2a2)+DateUtils[aN(0x33b)](d)+aN(0x267)+DateUtils[aN(0x33b)](e));const j=0x5a,k=0x1e;let l=ApiUtils['readRangeSS'](SSId,SheetNames[aN(0x270)]+aN(0x30b),aN(0x27f),aN(0x221));l=l[aN(0x1ea)]((E,F)=>{const aO=aN;return F[0x0]&&F[0x2]&&E[aO(0x1d2)](F[0x0]),E;},[]),l=l[aN(0x2fd)](-j);let m=SysUtils['pagination'](l,k),n={'topOrderBy':aN(0x305),'orderBy':{'field':aN(0x305),'mode':aN(0x2a1)},'limit':0x1e},o=[],p;while(e>=d){let E=DateUtils['getStrDateFromSerialNumberDate'](d);for(let F of m){o['push']({'currentPeriod':E,'nmIds':F});}d++;}let q=+(c[aN(0x321)](aN(0x27c))||0x0),r,s=0x3,t=0x5208,u=[],v,w=0x0,x,y=0x1,z=o[aN(0x2e0)];if(z){let G=o[aN(0x24a)](H=>{const aP=aN;return n[aP(0x2a6)]=H[aP(0x2a6)],n[aP(0x1c2)]={'start':H[aP(0x1c2)],'end':H['currentPeriod']},{'url':aP(0x22a),'options':{'method':aP(0x266),'headers':g,'payload':JSON[aP(0x1d4)](n),'contentType':aP(0x27d),'muteHttpExceptions':!![]}};});console[aN(0x25d)]('Всего\x20запросов:'+G[aN(0x2e0)]+'.\x20Максимум\x20запросов\x20за\x205\x20мин:\x2015.'),q=+(q||0x0),console['log'](aN(0x261),q);q&&console[aN(0x25d)](aN(0x1bc)+q*f);G=G[aN(0x2fd)](q*f,(q+0x1)*f),console[aN(0x25d)](aN(0x2dc)+G[aN(0x2e0)]+aN(0x1eb));for(let H of G){console[aN(0x25d)]('Before\x20request:\x20xRatelimitRemaining\x20&&\x20waitFor:'+y+',\x20'+w);!y&&w>0x0&&Utilities[aN(0x207)](w);r=0x0;while(r<s){let I=C(H,i);if(I===0x0){w=v+t-Date['now'](),i++;break;}else{if(I===-0x1)console[aN(0x25d)](aN(0x26c)+i+'\x20на\x20попытке:\x20'+r+aN(0x1ac)+w/0x3e8),r++;else I>0x1&&(console[aN(0x25d)](aN(0x323)+I),H[aN(0x32b)]['payload'][aN(0x2ed)]=I,r+=0.5);}w=x?(x+0x1)*0x3e8:t,!y&&w>0x0&&Utilities['sleep'](w);}}r===s&&console[aN(0x25d)](aN(0x237)+i+aN(0x1f4)),console['log'](aN(0x201)),console[aN(0x25d)](h[aN(0x2e0)]),p=D(h);}else p='Возможно\x20период\x20для\x20запроса\x20задан\x20не\x20корректно.';q++;let A=q*f,B=A<z?!![]:![];B?(console[aN(0x25d)](aN(0x1fa),q),c['setProperty'](aN(0x27c),q),ScriptApp['newTrigger']('searchTextsJamTrigg')['timeBased']()[aN(0x2f9)](0xea60)[aN(0x263)]()):c[aN(0x2d8)]('searchTextsJam');console[aN(0x25d)](aN(0x261),q,'setTriggFlag:',B),console[aN(0x25d)](p),console[aN(0x25d)]('searchTextsJam\x20FINISHED');function C(J,K){const aQ=aN;console['log'](aQ(0x333),K),x=0x0;let L=UrlFetchApp[aQ(0x1e4)](J['url'],J[aQ(0x32b)]);v=Date['now'](),Utilities[aQ(0x207)](0x1f4);let M=L[aQ(0x21a)](),N=L[aQ(0x1b1)]();y=+(N[aQ(0x244)]||0x0),console[aQ(0x25d)]('Запрос\x20'+K+aQ(0x2d0)+M+',\x20xRatelimitRemaining:'+y+'\x20'+(message=M==0x190?L[aQ(0x271)]():'')+'.');message&&console['log'](message);if(M===0x1ad)x=N[aQ(0x2b6)],console[aQ(0x25d)](M,'Превышено\x20количество\x20запросов\x20в\x20минуту,\x20запрос\x20#'+K+aQ(0x2a8)+x);else{if(M===0xc8){let O=JSON[aQ(0x24f)](L[aQ(0x271)]());return O[aQ(0x2ee)]['date']=DateUtils[aQ(0x24d)](new Date(JSON[aQ(0x24f)](J[aQ(0x32b)][aQ(0x285)])[aQ(0x1c2)]['start'])),h[aQ(0x1d2)](O[aQ(0x2ee)]),O['hasNext']?O['page']+0x1:0x0;}}return-0x1;}function D(J){const aR=aN;u=J[aR(0x1ea)]((K,L)=>{const aS=aR;let M,N=Math[aS(0x217)](L[aS(0x274)]);return Array[aS(0x249)](L['items'])&&(M=L[aS(0x2e3)][aS(0x1ea)]((O,P)=>{const aT=aS;return O['push']([N,P[aT(0x28b)],P[aT(0x358)],P[aT(0x1e7)][aT(0x1dc)],P['weekFrequency'],P[aT(0x31a)]['current'],P['avgPosition'][aT(0x1dc)],P[aT(0x2ea)][aT(0x1dc)],P[aT(0x2ea)]['percentile'],P[aT(0x2ca)][aT(0x1dc)],P[aT(0x2ca)]['percentile'],P[aT(0x2af)][aT(0x1dc)],P[aT(0x2af)][aT(0x272)],P[aT(0x1d9)][aT(0x1dc)]]),O;},[])),K=K[aS(0x2dd)](M),K;},[]);if(u[aR(0x2e0)]){console[aR(0x25d)](aR(0x301)),p=aR(0x31c)+u[aR(0x2e0)]+'.';let K=ApiUtils[aR(0x235)](SSId,SheetNames[aR(0x27c)]+'!A5:N',aR(0x27f),'SERIAL_NUMBER'),L=K[aR(0x1ea)]((P,Q)=>{let R=Q[0x0]+'~'+Q[0x1]+'~'+Q[0x2];return P[R]=Q,P;},{}),M=u[aR(0x1ea)]((P,Q)=>{let R=Q[0x0]+'~'+Q[0x1]+'~'+Q[0x2];return P[R]=Q,P;},{});Object['assign'](L,M),u=Object['values'](L),u[aR(0x223)]((P,Q)=>P[0x2]-Q[0x2])[aR(0x223)]((P,Q)=>(''+P[0x1])[aR(0x268)](''+Q[0x1]))['sort']((P,Q)=>P[0x0]-Q[0x0]);let N=SS['getSheetByName'](SheetNames['searchTextsJam'])[aR(0x1b2)]()-0x4,O=N-u['length'];O>0x0&&(u=SheetUtils[aR(0x200)](u,O)),ApiUtils[aR(0x28a)](SSId,u,SheetNames[aR(0x27c)]+aR(0x1d8));}else p=aR(0x1c3);return p;}}function getClustersToSearchText(){const aU=a1;checkAccess_();var c='https://clusters.1gb.ru/search/';let d=ApiUtils[aU(0x235)](SSId,SheetNames[aU(0x27c)]+aU(0x339))[aU(0x229)](Infinity),e=[...new Set(d)],f=JSON[aU(0x1d4)]({'values':e}),g={'method':aU(0x266),'contentType':'application/json','payload':f},h=UrlFetchApp[aU(0x1e4)](c,g),i=h['getResponseCode'](),j=h[aU(0x271)](),k;if(i==0xc8){let l=JSON['parse'](j),m=l[aU(0x324)]['reduce']((o,p)=>{const aV=aU;return o[p[aV(0x22c)]]=p['cluster'],o;},{});k=aU(0x2ac)+Object[aU(0x1f3)](l['results'])[aU(0x2e0)];let n=d[aU(0x24a)](o=>[m[o]||'']);k+=aU(0x2fc)+n['length'],ApiUtils['writeToSS'](SSId,n,SheetNames['searchTextsJam']+aU(0x33d));}else k=aU(0x264)+i+'.\x20'+j;return console[aU(0x25d)](k),{'msg':k,'propValue':null,'setTriggFlag':![]};}function getHeaderDateParams(c){const aW=a1;let d=ApiUtils['readRangeSS'](SSId,c+aW(0x2a4),aW(0x27f),'SERIAL_NUMBER'),e=Math[aW(0x328)](DateUtils[aW(0x24d)](new Date())),f=d?.[0x0]?.[0x0]||e-0x4,g=d?.[0x1]?.[0x0]||e;return{'dateFromSer':f,'dateToSer':g};}function a(){const c8=['oIbVAYe','q2fUBM90ignHBgWGu3bYzwfKC2HLzxrbChaUC2HVD05VDgLMAwnHDgLVBIGPigzYB20GDgHPCYbJB250zxH0lG','y2XLyxjpCMrLCLjVD3nuCMLNzW','ignVzgu6','z2v0u2HLzxrjza','Ec1YyxrLBgLTAxqTCMv0CNK','C2vYDMLJzxmHrZm6sa','Dg9tDgfYDevUzeLUzgv4zxm','Dg9mB2nHBgvtDhjPBMC','y3jLyxrLrM9SzgvY','BwLUrgf0zvn0yxrbqG','0jlqVTc30lZqVTc20l3qVIdqV9c10ydqUnc+0lqG0ltqU9gpinc30ldqV9ga0l7rGDcWinc30ldqTncW0l0G0l3qTsdqUTc+0ydrGnc10lRrGTc90l4U','BM93','iue1oKe','j9cH0klqKncI0jJqODcI0jJqMTcqjW','CMvHzfjHBMDLu1mGzMfPBgvKihDPDgGGzxjYB3iGjxm','BMv4Da','y2HHBMDLvgLTzq','0jtqVTcX0ldqSTc70lxqVDc+inc/0yprGDgc0yVrHsdrGDgc0ydqVTc6oG','iue1oKm','y29SDw1Uq291BNq','yw5HBgL0AwnZsMfT','DMLLD3m','y29Su3vT','uMvXDwvZDcbKyxrHigzYB206','ywrKvg9dyxj0','0jlrI9c/0l7qU9c90lxqVDc40luG0lFqSncY0lxrGngi0lxqVDc+lIdqL9cW0lprGngd0lBqTDc90ySG0llrGDc1inc30ldqV9c40yhqUc4','nJC2nJy5DhnUCeni','z2v0vMfSDwu','z2v0swq','C3rHCNrdB2X1Bw5jBMrLEa','oIbJB2rLia','B3bLBKnHCMrdB3vUDa','z2v0q29UDgvUDa','incH0ylrGnc+0lRqUcdqVTcX0l3qVTcY0lVqTDc90ySG0yhqVIdrGDgc0ydqVTc60lG6ia','z2v0tMfTzq','z2vUzxjHDgvdB250Aw51B3vZugvYAw9KC0zHC3q','y29UDgvUDa','u3rHCNqGiNn0yxrlzxLxB3jKCYiGzM9Yia','zgvSzxrLuhjVCgvYDhK','z2v0uMfUz2u','mtm3oti5rgfnwg1U','y3jLyxrLvgvTCgXHDgvgCM9TrMLSzq','0j7rGTc+0lhrGncW0l3qVIdqT9cW0l/rGnc+0yhqVTcYoG','y29Uy2f0','u3rHCNqGiMfUywX5DgLJtM1jzfbLCMLVzciGzM9Yia','zNjVBq','BgvUz3rO','CMvXDwvZDhmGBNvTyMvYigLZoG','ogzcz3rcqq','AxrLBxm','nY4XlTcF0l7qUngb0lRqVTcY0yVqUsdqT9cW0l/rGnc+0yeG0jtqTTc10lW','lNjLDhvYBLTD','yxbWCW','lIbYzxr1CM4Gw10','CM91BMq','C2vYDMLJzxmHqtm6qG','B3bLBKnHCMq','yMvNAw4','z2v0tNvTq29SDw1UCW','CgfNzq','zgf0yq','u3rHCNqGiMTLEvDVCMrZiIbMB3iG','y3vYC29Y','lKPtt04','C2HVD01VzgfSrgLHBg9N','z3jPzfbYB3bLCNrPzxm','yxnJ','ywr2u3rHDa','0j7qSDc90l7qSTc70lxqVDc40luG0yhrGTcW0ylqUngb0ylqUnc60lGG0ydqTDc60lVqSnc80l3rI9gfinc60ldqVnc/0ldqVDc40lKG0lFqSncY0lxrGngi0lxqVDc+lIdqNTcX0l3qVTcY0lVqTDc90l4G0yhrGTga0l7qUJOG','j9cG0jxqMTcB0jdqNncqjW','z2v0q29SDw1U','ywz0zxi','C2HLzxrZ','zxjYB3i','lIdqLnc+0lhqSncY0lVqTDc90l4G0yhrGTga0l7qUJO','C2XPy2u','0j/rGnc10llrI9gi0lxqVDc+inc60l7qU9c40yFqTDgb0ylqSTc+inc30ldqV9ga0l7rGDc+0liG0liG0lZqUnc90yprGTgdlcdqT9cW0l/rGnc+0yeGiW','z3jVDxbFBgLZDa','ExL5Es1nts1KzcbisdPTBtPZCW','0j7rGTcY0lxrGIdqV9c+0lVrG9gh0lxqVs4G0j/qSnga0yhqUnc8lG','CMvXDwvZDhm7','y2XLyxjdB250zw50','C3rHDhm','B3bLBLrVq2fYDa','C3vTCW','r01u','0j7qSDc90l7qSTc70lxqVDc40luG0yhqV9c40yhqUTcWinga0lxqUTc70ldqVnc90yVrHsdqUTcW0lZqV9cW0l3qUnc5inc30ldqSTc10ydrInc10l3qVI4G0jFqSnc/0lJrGDcW0l3qVIdrGDgc0ydqVTc6oIa','ms7qNTcX0l3qVTcY0lJrGTgmincI0l7qSTcW0ydrIW','ExL5Es1nts1KzcDuj0HioM1ToNnZjY4WmdbAjW','iueYoKm','vevyva','yNv5B3v0C1bLCMnLBNq','ywr2zxj0u3rHDhvZ','Bwf4','z2v0u3rYrgf0zvrPBwvgCM9Tu2vYAwfStNvTyMvYrgf0zq','jNrVpq','0jdqSTgc0l7rGnc40lFqSngg0lJrJYdqVDc1ingc0ydqTDcX0ypqTDgc0yhrJY4','j9cA0j7qNDcI0jxqNDcIjW','0l7rInc40lhqUTcWinc30ldqS9ga0ypqT9c60lGG0ltqSnc90l3rI9gfoIa','C3rHCNq','mJbsC3rID1K','z2v0uMfUz2vmAxn0','A2v5CW','0j7rInc40lhqUTcWinc/0ydqUcdqSTgl0l/qVTc70l3qTDc90lJqUcdqT9cW0l/rGnc+0yhqSdO','BwvKAwfUug9ZAxrPB24','z2v0qwn0AxzLu3bYzwfKC2HLzxq','0khqSDc+0yaG0ltqSnc90l3rI9gfigfUywX5DgLJtM1jzfbLCMLVzcdqT9cW0llqTDga0yJqTDc9lIdqLnc+0lhqSncY0lVqTDc90l4G0yhrGTga0l7qUJOG','oIdqVTgi0lJqSDc60laG0lFqSnc/0lJrGDc4inc00ldqVDc90yVrHsa','mtK0nti5ugDTwM5p','zM9YrwfJAa','z2v0vwK','z2v0uhjVCgvYDhK','j9cq0jpqKncB0jJqOTcy0jRqKcC','0jtqSnc90l3rI9c1ingb0l7qTnc10ydqTTcW0yiG0lhqVTc70lxqTsdqVTc00l3qVTc5ingb0ylrGncW0l3qUngg0ySUincH0lhqVTgaingb0ylrGncW0l3qUngg0la6ia','CMvZDwX0CW','Aw5Zzxj0uM93C0fMDgvY','0j7rInc40lhqUTcWiq','lIbVChrPB25ZoG','y2vPBa','BMv3vhjPz2DLCG','y2HLy2TszxnWB25ZzunVzgu','B3b0Aw9UCW','0j3qTsdqT9cW0ltqSnc90ySG0l/qSnga0ldqVnc10ylrGnglingc0ydqUncZ0lprGnc+0liGy29TBvnLCNzPy2veyxrHlG','q9gc0ldrGI7qMTcW0lZqV9cW0l3qUnc5kgfWAsK','0j7rH9c40yhrGTc60laG0ltqUncW0l/qSnc30l7qVDc+0li','Dg9HC3q','sKWUyxv0Aa','yxbWzw5Kvg9tuW','z2v0uM93','0jFqSnc/0ydqVMm6ia','Aw5JBhvKzxm','0jlrGDc10lpqVIdqT9cW0l/rGnc+0yhqVTcYoG','Dw5ZAgLMDa','0j/rGnc+0ltqSnc20lGGkgfWAsK','r01ukZm6mda','iui1oKi','Dg1W','z2v0u3rYrgf0zuzYB21tzxjPywXoDw1IzxjeyxrL','BwLU','iu81','y2fTChntDgf0s2v5v29YzhmGrKLosvniruq','0j7rInc40lhqUTcWinc/0ydqUcdqVTgh0lJrGDgc0lRqTsdrGDgc0ydqVTc6oG','yxjYx3rVx29IAL9RzxK','inc60ldqVnc/0ldqVDc40y/qVnc4lG','C2v0q29UDgvUDa','qxv0Ag9YAxPLzcbZy29Wzxm6ia','zxzHBhvHDgu','inc90luG0lhrI9c7inc/0l7qU9gd0yFqTDc9lIdqMTc+0lq6','zNjX','kncD0luG0l7rInc40lhqUTcWksbYzwfKuMfUz2vtuY4G0j/qVTc/0yVrGTc60laG0yFrGTc10l3qUngpinc/0yprGDgc0l7qS9c+inc00lJqSnc/0ldqT9c+0l3qSdOG','DxbKu3vT','0j7rInc40lhqUTcWinc/0ydqUcdrGDc+0lFqTncW0l3qUnc4inc+0ylrH9c10ylqSce','AgvHzgvY','D2fPDg5NigzVCIaXCY4','yNv5B3v0C0nVDw50','0jFqSnc/0lJrGDgmincYihrLBxaT0ytqSnc50lSUincH0ylrGnc+0lO6','CMvTB3zL','C3bSAxq','C3rHCNrsB3DjBMrLEa','B3jKzxjZu3vTuNvI','z2v0','y2fTCeLKCZOG','ywrKvg9dyxj0q291BNq','0jZqTDc90y4','C3rHy2S','0jFqSncZ0ydrG9c30lRqScdrGsdqVDcW0yFqSnc70laG0yhqV9c40yhqUTcWlIdqNncW0lRrGDc40lZqSnc70yZqVDc+0luG0lRqVTc7lDcY0l4G0lFqSnc/0ydqVTgb0l7qSIdqVDcWingb0lxrGDgb0lJrJJOG','BM1jza','z2v0rgf0yvjHBMDL','vvnfuL9ftLrfuKve','DxbKvgLTzq','vxnLCNmGDhjPz2DLCIb1CgrHDgu','y3jLyxrLshrTBe91Dhb1DezYB21gAwXL','DxnLCKvUDgvYzwrgB3jTyxqUBNvTyMvYrM9YBwf0','AM9PBG','0klrGnc40lpqS9c10yaGC3rHDeTLEvDVCMrZvhjPz2CG0yprGDgc0ldqVDc+0llqU9c10l0G0lGG0yhrGncW0lhqVTgc0ldqTDgcingh0lxrGnc10lCGnsdqVnc40l0U','Ahr0Chm6lY9HzhzLCNqTyxbPlNDPBgrIzxjYAwvZlNj1l2fKDI92mI9MDwXSC3rHDhm','mZi3nJq1Cg5gDfj1','inc/0l7qSTgc0l7rGnc90yVqUsdqT9cW0l/rGnc+0yeG0yFqTDga0lxqTZOG','C3bSAwnL','z2v0uhjVzhvJDhm','DxbKyxrLsgLZDg9YEq','C3vJy2vZCW','z2v0sgvHzgvYCW','z2v0tgfZDfjVDW','uK9xuW','0j7rInc40lhqUTcWinc00l7rGDgc0ypqV9cWinc6inc60lVrJTgh0ym6ia','z2v0qwn0AxzL','Ahr0Chm6lY9HzhzLCNqTyxbPlNDPBgrIzxjYAwvZlNj1l2fKDI92ms9WCM9TB3rPB24Vywr2zxj0CW','CgfYC2vdC3y','yMf0y2HxCML0zvrVu1mGzMfPBgvKihDPDgGGzxjYB3iG','0khqTDga0llqTDgaincY0lxrGnc90ypqUYdqVTgi0lJqSDc60ymUienVzguG','C2fMzvjLBw92zuzPBhrLCG','u2nYAxb0ici','0khqSDc+0yaG0ltqSnc90l3rI9gfincX0ypqTnc10yiG0l/rGnc+0ltqVTc70lBqTDc9ingbinc30ldqV9ga0l7rGDcWoG','z2v0rMLSDgvY','nI7qNTcX0l3qVTcY0lJrGTgmigTLExDVCMrZ','zMLUzfjVD0fMDgvYrgf0zq','CNuTuLu','zw5KuM93sw5KzxG','y3vYCMvUDfbLCMLVza','0jtqSnc90l3rI9c1inc00lVrJYdqVTcX0l3qVTcY0lVqTDc90lJrJYdqVDc1incX0yVqU9c4inc/0l7qU9gd0yFqTDc90ySU','0jFqSncZ0ydrG9c30lRqScdqTncW0l3qVDgl0yuG0yeG','0klrGnc10lhrG9c10ylrGDgpincW0llrGTc+0ydqUnc30ldrHTc40y8U','vMfSDwvZ','ywXLCNq','mJe2otG5merks3jYCW','C3rHDgLZDgLJCW','0jRqVTc70lJrH9c10yhrGTcY0l4G0y/rH9c10lxqUIdqSIdrHncW0lNqU9c1ia','0j/qSnga0ldqVnc10ylrGngl','z2v0qxv0Ag9YAxPHDgLVBKLUzM8','0jJrGDgc0l7rGnc40y8G0lFqSngc0ydqSngckgfWAsKHqti6qq','0klqVTcY0ldrGngl','Dg9ju09tDhjPBMC','iue0oKi','y3jLyxrLshrTBe91Dhb1Da','ChvZAa','rK9stufuvevex1nuuKLorW','C3rYAw5NAwz5','yNv5B3v0C1n1Bvj1yG','uMvZCg9UC2vdB2rLigLZig5VDcaYmdaH','Bwf4rgf0zvn0yxrbqG','iue1','DMLZAwjPBgL0Eq','ns7qNTcX0l3qVTcY0lJrGTgmincq0l3qSnc70lJrGTc40lRrGYdqLnc20lxqVa','lcb4uMf0zwXPBwL0uMvTywLUAw5NoG','y3vYCMvUDa','z3jVDxbgAwvSzhm','ywrK','DxbKyxrLzef0','DxjS','mdeUmdeUmJeWma','w0DVB2DSzsbtAgvLDhnDia','C3rHDeTLEvDVCMrZ','zMv0y2G','yw5HBhL0AwnoBuLKugvYAw9K','C3rHDeTLEvDVCMrZvhjPz2C','zNjLCxvLBMn5','C2v0vMfSDwu','y3jLyxrLrMLSzq','CMvKDwnL','lIdqNncW0lRrGDc40lZrG9c8inc30ldqV9ga0l7rGDc+0liG0lFqSca1inc80lJqVtOGmtuU','Bwv0Ag9K','zgvSzxrLvhjPz2DLCG','A2v5D29Yza','CMv2zxjZzq','A2v5D29Yzhm','inc30ldqSTc10ydrInc10l3qVI4','iue1oKK','DMfSDwvZ','inc90luG0lhrI9c7inc+0lhrGncW0lhqVTgc0ldqVsdqUTc+0ydrGnc10lRrGTc90l4UincF0ydqTDcY0yVrInc10l0G0lVqUnc80lJrGIdqT9cW0l/rGnc+0yhqVTcYlG','z2v0rgf0yufZu3rYAw5N','0j7rH9c40yNqTDc90ySG0ltqUncW0l/qSnc30l7qVDglia','0j7qSDc90l7qSTc70lxqVDc40luG0yhrGTcW0ylqUngb0ylqUnc60lGGqurwlMTLExDVCMrZ','mtu0odi1v3bAuLnx','0j7qSDc90l7qSTc70y/qTDc8inc00l3qTDc5oIa','0kprGDgc0ldqVDcW0llqU9c40llqSnc10lWG0ylrGnc40lpqS9c10yaG0l3qScdrGDc70lxqTngd0y7rIDc40lKG0lFqSnc/0yprGDc6ingb0lRrGnc40l/rGTcWingh0lxrGnc10lCGmsdqVnc40l3rG9gc0ymUincH0lhqVTgaingb0l4G0yhrGTga0ldqVDc40yBrIZO','ywrKsxrLBq','nJm2AxbVsxLU','zxzLCNLiB3vYCW','0j7rGTc+0lhrGncW0l3qVIbUBuLKCZO','C2vHCMnOsMfT','y2XLyxjcEufKzejSyw5RuM93','C3vJy2vZC1jLC3vSDhmUBgvUz3rOoG','otzWzM1vEvG','Cg9W','0jdqSTgc0l7rGnc40lFqSngg0lJrJW','Ahr0Chm6lY9HzhzLCNqTyxbPlNDPBgrIzxjYAwvZlNj1l2fKDI92mc9ZDgf0CY9RzxL3B3jKCZ9HzhzLCNrFAwq9','0jlrGDc10lpqVIdrGDgc0ydqVTc6inc00ldqVDc90yVrHsdqV9c10ydqTDc0inc30ldqV9c40yhrJngooIa','C2XLzxa','0j7qSDc90l7qSTc70lxqVDc40luG0lJrGDgc0l7rGnc40lGG0lFqSngc0ydqSngcinc30ldqSTc10ydrInc10l3qVI4G0jFqSnc/0lJrGDcW0l3qVIdrGDgc0ydqVTc6oIa','Dg90ywW','zw50CMLLCW','C2v0uhjVCgvYDhK','yw5HBhL0AwnoBuLKugvYAw9KvhjPz2C','0ytqVTga0lZqSngcinc00lVrJYa','DMfSDwvsyw5Nzxm','0jFqSnc/0ydqVTgb0l7qSIdqUnc80lxqVsdqOncAoG','AgfZtMv4Da','0j/rGnc+0llqTDga0lRqScdqSncY0ylqVTga0lJqT9cW0yBqUnc4lG','z2v0u2HLzxrcEu5HBwu','qxv0Ag9YAxPHDgLVBLn0yxr1CW','ywr2swq','zgvSzxrLuM93CW','inc90ldqUDc00lxqVsdqSIdrGDgc0ydqVTc60luGiZOG','zMXVB3i','lIdqODc/0lJrGDc+0lOG0lhrG9c00lxrGIdqVTcZ0ydqSnc90lJrH9c10l0G0l/qVTgb0lVqTDc00l3qUnc80lGG','0khqSDc+0yaG0ltqSnc90l3rI9gfincX0ypqTnc10yiG0l/rGnc+0lJqT9cY0lxqTngr0l0G0yeG0l3qSngh0ldqU9cWingb0l/qUngb0lRqSa','z2v0uMvZCg9UC2vdB2rL','iueXoKi','zw5K','DgL0Bgu','qxv0Ag9YAxPLzcbHBgWGC2nVCgvZihn1y2nLC3nMDwXSEs4','C2TPCcbYzxf1zxn0lG','z2v0rgf0zuzYB21tzxjPywXoDw1IzxjeyxrL','u0vssufmx05vtujfuG','0jFqSnc60ldqT9glicHHCgKP','C29YDa','ChjLDMLVDxnqzxjPB2q','ywr2zxj0swq','0j7qSDc90l7qSTc70lxqVDc40luG0ylrGnc40lpqS9c10ydqSca','mJryz3HqExK','0l3qScbLBg06ia','zMXHDa','Ahr0Chm6lY9ZzwXSzxiTyw5HBhL0AwnZlwfWAs53AwXKyMvYCMLLCY5YDs9HCgKVDJiVC2vHCMnOlxjLCg9YDc9WCM9KDwn0l3nLyxjJAc10zxH0CW','qxv0Ae1Vzgu','CgHYyxnL','0jlrGDc1inc00ldqVDc90yVqTsdqV9c+0lVrG9gh0lxqVDgllIdqODcX0l7rGcdqT9cW0llqTDga0yJqTDc9lG','DgLTzujHC2vK','z2v0rM9SzgvYC0j5tMfTzq','ChjVCgvYDgLLCW','zM9YBwf0rgf0zq','qwnJzxnZigrLBMLLzcb0BYb0AgLZigXPyNjHCNKGzNvUy3rPB24','C2v0sgvPz2H0','yw5HBhL0AwnoBuLKugvYAw9KiezjtKLtseve','CMvHzfjHBMDLu1m','ywr2zxj0CW','0jFqSnc/0ydqVTgbia','Aw5KzxHpzG','rLvmta','zMLUzeXHC3rjBMrLEa','C2v0tNvTyMvYrM9YBwf0','iuK1','0jFqSncZ0ydrG9c20lxqVDc+inc90l7qSTgl0yuG0ylqVTcY0ldrGnc+0li6ia','C3vTx3bYAwnL','C2HRCW','iueYoKq','C2vSzwn0zwrqzxjPB2q','r2v0igfKDK5HBwuGuMvZCg9UC2vdB2rLoIa','Dg9tDhjPBMC','Ec1YyxrLBgLTAxqTCMvTywLUAw5N','u3bYzwfKC2HLzxrZ','y2XLyxjbBMfSExrPy3nsB3DZvhjPz2C','0j/qSnga0ldqVnc10ylrGngliuiXma','yMf0y2HvCgrHDgvtuYbMywLSzwqGD2L0AcbLCNjVCIaLCW','AxnbCNjHEq','BwfW','0j7rGTcY0lxrGIdqVDcWinc30ldqV9ga0l7rGsa','0kprGDgc0ldqVDcW0llqU9c40llqSnc10lWG0ylrGnc40lpqS9c10yaG0l3qScdrGDc70lxqTngd0y7rIDc40lKG0lFqSnc/0yprGDc6lIdqODcX0l7rGcdrGDc+ingb0ylrGncW0l3qUngg0yS6','z2v0u2vYAwfStNvTyMvYrgf0zq','z2v0twf4uM93CW','CgfYC2u','0khrGTcW0ylqUngb0ylqUnc60laG0ydqTDc60lVqSnc80yS','y2fYzhm','igLKihbLCIbYzxf1zxn0oG','yMf0y2HxCML0zvrVu1mGB2SH','z2v0u2HLzxrZ','Cgf5BwvUDfr5Cgu','yxnZAwDU','pgH0BwW+','B3jKzxjZq291BNq','Dg9eyxrLu3rYAw5N','DMvUzg9Yq29Kzq','ndaYmJmXAvfcAKnz','0j/qSnga0ldqVnc10ylrGngliui5','Bg9N','yMf0y2HszwfKuMfUz2vtuYbMywLSzwqGD2L0AcbLCNjVCIaLCW','zw5Kq29SDw1Usw5KzxG','A2v5v29Yzhm','ChjVCfzHBhvLoG','CMvRBa','y3jLyxrL','0jRqVTc0inc+0ylqSTc10ylqSdOG','zMLSBa','Cg9ZDa','inc/0l4G','Bg9JywXLq29TCgfYzq','z2v0tNvTuM93CW','nc7qNTcX0l3qVTcY0lJrGTgmingb0ylqSngc0lJrGDgc0lJqUTgdincG0jO','BwvZC2fNzq','0jFqSnc/0ydqVTgbingbinc60l7qTnc+0lWHptiWmdOG','y2XLyxjtywXLC1jVD3nuCMLNzW','Ahr0Chm6lY9Zy3jPChqUz29Vz2XLlMnVBs9TywnYB3mVCY9bs2z5y2j6u2Ltm2Hlognsy2zluMLduw8Yr3LPDxHIuM0ZEgHIuhjyDxDrn05tBhvQttvvzhiTwwLdltfIzwryudDnCZbbu2iVzxHLyW','y29UDMvYC2LVBNm','ChjVzhvJDhm','z2v0q29UDgvUDfrLEhq','CgvYy2vUDgLSzq','DMfSDwvpzG','zgf0zq','z2v0u2vYAwfStNvTyMvYrgf0zu5Vr01u','ExL5Es1nts1Kza','zgf0zuzYB21tzxiSigrHDgvuB1nLCG','0j7qSDc90l7qSTc70lxqVDc40luG0yhqV9c40yhqUTcWincG0jO','CMvZCg9UC2uGBNvSBa','BMfTzq','lIbtA2LWihbHz2uG','C2vHCMnOvgv4Dhnkyw0','yxbWBgLJyxrPB24VANnVBG','l2XPBwL0uM93CZO','vu5gt1jnqvrururFvKfmvuu','C3rHDhvZ','z2v0t0f1DgHuB2TLBG','zgf0zv9MCM9Tx3n0CG','z2v0q2X1C3rLCNnuB1nLyxjJAfrLEhq','0j/rGnc+0ltqVTc70lBqSnc10lWG0yhqSDc+0yaG0yeGCMvXDwvZDdO','Cgf5Bg9Hza','0j7rInc40lhqUTcWincYingc0lxqU9c1inc30ldqV9ga0l7rGDcWlIbdB2rLidqWma','rMLSzxm','y2XPy2TZ','C2HLzxrZl3bYB3bLCNrPzxmVz3jPzfbYB3bLCNrPzxmVCM93q291BNqSC2HLzxrZl3bYB3bLCNrPzxmVz3jPzfbYB3bLCNrPzxmVy29SDw1Uq291BNqSC2HLzxrZl3bYB3bLCNrPzxmVDgL0Bgu','D3jPDgvuB1nt','Dgv4Da','ywr2sgLZDg9YEq','D2fYBG','ywr2tgLZDa','z2v0vMfSDwvZ','DhLWzq','C3vT','BM1jra','phrPDgXLpLnPz24GAw4GlsbhB29NBguGqwnJB3vUDhm8l3rPDgXLpG','yMf0y2HszwfKuMfUz2vtuW','yMf0y2HvCgrHDgu','B3bLBKj5swq','CMvXDwvZDhmUBgvUz3rOigLZoG','0jlqVTc30lZqVTc20l3rI9c5inc40l3rGTc10ydqSTcW0lSG0l/qVTc70yprH9c10l3qUngpingb0ylqSngc0lJrGDgc0lJqUTc4idmXingb0yprGTc+0lO','Ahr0Chm6lY9JB250zw50lwfWAs53AwXKyMvYCMLLCY5YDs9JB250zw50l3yYl2DLDc9JyxjKCY9SAxn0pW','z2v0vgLTzq','mxa3mhL0ttfsyK5Mv3rIr0TuD2jeqvv0A1rpCfv3nufsnhvxrvu4vuzrng8','inc90laG0l/qVTc/0yVrGTc60lu6ia','CgvYAw9K','mY7qNTcX0l3qVTcY0lJrGTgminc40yhrGTc+0ydqUngoincG0jO','DgvTCa','zM9YBwf0rgf0zvrVx2rKx01nx3L5ExK','zgvZyW','0jFqSncZ0ydrG9c30lRqScdqTncW0l3qVDgl0yuGingbia','z2v0uhjVAMvJDfrYAwDNzxjZ','iuiXoKiY','Aw5MBW','BM1jzhm','C3rHDa','lcbyuMf0zwXPBwL0uMv0CNK6ia','AgfZ','0jRqVTc7lDcY0l4G0l7rGTc+0lhrGncW0l3qVDgl0yuG0lRqSnc80l/qSnc90lJqUsa+ia','yxriB3vY','0j/qVTc70yprH9c10l3qVIdqT9cW0l/qUngb0lxqUsa','yxbWzw5K','ywrKu2vWyxjHDg9Y','B3jKzxjZ','lcdrGtOG'];a=function(){return c8;};return a();}function getAccount(){}function getMenu(c=''){const aX=a1,d=SpreadsheetApp[aX(0x320)]();let e=d['createMenu'](aX(0x355));e['addItem'](aX(0x309),aX(0x1ae)),e[aX(0x1fb)]('2.Обновить\x20список\x20РК','getAdvCampList')['addSeparator'](),e[aX(0x1fb)](aX(0x29e),aX(0x1af)),e[aX(0x1fb)](aX(0x26a),'getAdvStatistic')['addSeparator'](),e[aX(0x1fb)](aX(0x1da),'analyticNmIdPeriod'),e['addItem'](aX(0x1be),aX(0x260))['addSeparator'](),e[aX(0x1fb)](aX(0x2e4),aX(0x27c)),e[aX(0x1fb)]('7.2.Обновить\x20кластеры\x20Поисковый\x20запрос',aX(0x283))[aX(0x2ae)]()[aX(0x2ae)](),e['addItem']('Авторизация',aX(0x330)),e['addToUi']();}const SheetUtils={'safeRemoveFilter':function(c){const aY=a1;try{const d=c[aY(0x1bd)]();if(d)d[aY(0x34e)]();}catch(f){}},'insertRowsForNewData':function(c,d,e){const aZ=a1;let f=c[aZ(0x24e)](),g=d+e-f;g>0x0&&(c[aZ(0x325)](f,g),console[aZ(0x25d)](aZ(0x2c3)+g));},'fillLastUndefined':function(c,d=0xf,e=''){const b0=a1;c[b0(0x31f)](f=>{for(i=d;i>=0x0;i--){if(f[i]!==undefined)break;f[i]=e;}});},'clearByAddBlankRow':function(c,d){const b1=a1;let e=c[b1(0x1ea)]((g,h)=>{const b2=b1;if(h[b2(0x2e0)]>g)g=h[b2(0x2e0)];return g;},0x0);const f=Array(d)[b1(0x265)](Array(e)[b1(0x265)](''));return c=c[b1(0x2dd)](f),c;},'group_list':function(c,d,e){const b3=a1;c[b3(0x31f)]((l,m)=>{const b4=b3;let n='';d[b4(0x31f)](function(o){n+=c[m][o];}),c[m][b4(0x1d2)](n);});let f=c[0x0][b3(0x2e0)],g=f-0x1,h=c['reduce'](function(l,m){const b5=b3;return l[m[g]]=l[m[g]]||[],l[m[g]][b5(0x1d2)](m),l;},{}),j=Object[b3(0x1f3)](h),k=[];return j['forEach'](function(l){const b6=b3;let m=SheetUtils[b6(0x2c8)](l,e);m[b6(0x203)](),k[b6(0x1d2)](m);}),k;},'groupListFast':function(c,d,e){const b7=a1,f={},g=c['length'];for(let h=0x0;h<g;h++){const j=c[h];let k=d['map'](l=>j[l])[b7(0x1a8)]('|');if(k in f){const l=f[k];e['forEach'](m=>{const b8=b7;l['sums'][m]=(l[b8(0x306)][m]||0x0)+(j[m]||0x0);});}else f[k]={'groupFields':d[b7(0x24a)](m=>j[m]),'sums':e[b7(0x1ea)]((m,n)=>{return m[n]=j[n]||0x0,m;},{})};}return Object[b7(0x1f3)](f)['map'](m=>{const b9=b7,n=[...m[b9(0x1dd)]];return e[b9(0x31f)](o=>{const ba=b9;n[o]=m[ba(0x306)][o];}),n;});},'updateTable':function(c,d,e){const bb=a1;let f=SheetUtils['arr_to_obj_key'](c,e),g=SheetUtils[bb(0x340)](d,e);Object['assign'](f,g);let h=Object[bb(0x1f3)](f);return h;},'update_table_keep_column':function(c,d,e,f){const bc=a1;let g=SheetUtils[bc(0x340)](c,e),h=SheetUtils['arr_to_obj_key'](d,e);for(row in h){g[row]=h[row][bc(0x2dd)](g[row]?g[row][f]:'');}return Object[bc(0x1f3)](g);},'updateTableKeepColumns':function(c,d,e,f){const bd=a1;let g=SheetUtils['arr_to_obj_key'](c,e),h=SheetUtils['arr_to_obj_key'](d,e),i={};Object[bd(0x256)](i,g,h);for(let j in g){f[bd(0x31f)](function(k){i[j][k]=g[j][k];});}return Object['values'](i);},'arr_to_obj_key':function(c,d){const be=a1,e=c[be(0x1ea)](function(f,g){let h='';for(let i of d){h+=g[i];}return f[h]=g,f;},{});return e;},'getDifferenceTab':function(c,d){const bf=a1;let e=d[bf(0x24a)](g=>{const bg=bf;let h=[...g];for(i=0x8;i<0x12;i+=0x1){h[i]=parseInt(g[i])[bg(0x2b9)](bg(0x1c0));}return h[bg(0x243)]();}),f=[];return c['forEach'](function(g){const bh=bf;let h=[...g];for(i=0x8;i<0x12;i+=0x1){h[i]=parseInt(g[i])[bh(0x2b9)](bh(0x1c0));}console['log']('элемент:\x20',h[bh(0x243)](),bh(0x216),e[bh(0x238)](h[bh(0x243)]())),e['indexOf'](h[bh(0x243)]())===-0x1&&f['push'](g);}),f;},'tofillSkipCells':function(c,d,e=''){return c['forEach'](f=>{f[d]===undefined&&(f[d]=e);}),c;},'fillAllUndefined':function(c,d=0xf,e=''){return c['forEach'](f=>{for(i=0x0;i<d;i++){f[i]===undefined&&(f[i]=e);}}),c;},'colSum':function(c,d,e=![]){const bi=a1;let f=c[0x0];for(let g=0x1;g<c[bi(0x2e0)];g++){for(let h of d){e?f[h]=Math[bi(0x2e8)]((+f[h]+(c[g][h]||0x0))*0x64)/0x64:f[h]=+f[h]+(c[g][h]||0x0);;}}return f;}},ApiUtils={'batchWriteToSS':function(c,d,f,g=a1(0x35a)){const bj=a1;try{const h=f[bj(0x24a)]((j,k)=>{return{'range':j,'values':d[k]};}),i={'data':h,'valueInputOption':g};return Sheets[bj(0x245)][bj(0x1c6)]['batchUpdate'](i,c),console['info'](bj(0x253)),!![];}catch(j){console[bj(0x2fb)](bj(0x1b8)+j['stack']);throw new Error(j[bj(0x356)]);}},'writeToSS':function(c,d,f,g=a1(0x35a),h=a1(0x28a)){const bk=a1,i={'valueInputOption':g,'data':[{'range':f,'majorDimension':bk(0x1b3),'values':d}]};try{const j=Sheets[bk(0x245)][bk(0x1c6)][bk(0x295)](i,c);if(j)return console[bk(0x25d)](h+':\x20ok!'),!![];return console['log'](bk(0x279)),![];}catch(k){return console[bk(0x25d)](h+':\x20failed\x20with\x20error\x20'+k[bk(0x26b)]),![];}},'appendToSS':function(c,d,f,g='USER_ENTERED',h=a1(0x331)){const bl=a1;let i={'majorDimension':bl(0x1b3),'values':d},j={'valueInputOption':g};try{const k=Sheets[bl(0x245)][bl(0x1c6)][bl(0x2ad)](i,c,f,j);if(k)return console[bl(0x25d)](h+bl(0x2b1)),!![];return console['log'](bl(0x279)),![];}catch(l){console[bl(0x25d)]('appendToSS\x20failed\x20with\x20error\x20%s',l['message']);throw new Error(h+bl(0x31d)+l[bl(0x26b)]);}},'readRangeSS':function(c,d,f=a1(0x27f),g=a1(0x1d3)){const bm=a1;try{optionalArgs={'dateTimeRenderOption':g,'valueRenderOption':f};const h=Sheets[bm(0x245)]['Values']['get'](c,d,optionalArgs);if(h['values'])return h[bm(0x1f3)];return console['info'](bm(0x347)+d+bm(0x2e7)),[];}catch(i){return console['log'](bm(0x2c0),i['message']),![];}},'batchUpdateTextFormatSS':function(c,d,f){const bn=a1,g=c[bn(0x2ce)](),h=d[bn(0x2b5)](),i=ApiUtils[bn(0x2b8)](d,f);try{let j={'requests':[{'repeatCell':{'range':{'sheetId':h,'startRowIndex':i[bn(0x350)],'endRowIndex':i[bn(0x1c1)],'startColumnIndex':i[bn(0x2cf)],'endColumnIndex':i[bn(0x25f)]},'cell':{'userEnteredFormat':{'numberFormat':{'type':bn(0x30c)}}},'fields':bn(0x1a7)}}]};const k=Sheets[bn(0x245)][bn(0x295)](j,g);if(k)return k;return console['info'](bn(0x20d)+f+'\x20не\x20установлен'),[];}catch(l){return console[bn(0x25d)](bn(0x248),l['message']),[];}},'batchReadRangeSS':function(c,d,f=a1(0x27f),g=a1(0x1d3),h=a1(0x1b3)){const bo=a1;try{let i={'dateTimeRenderOption':g,'valueRenderOption':f,'majorDimension':h,'ranges':d};const j=Sheets[bo(0x245)]['Values']['batchGet'](c,i);if(j[bo(0x20e)])return j['valueRanges'];return console[bo(0x2a5)]('(Не\x20ошибка)\x20batchReadRangeSS.Попытка\x20чтения\x20пустого\x20диапазона:\x20'+d+bo(0x2e5)),[];}catch(k){return console['log'](bo(0x25e),k['message']),[];}},'getAllRangesValues':function(c,d,e=a1(0x27f),f=a1(0x1d3),g=a1(0x1b3)){const bp=a1;let h=this[bp(0x294)](c['getId'](),d,e,f,g),i=h['map'](j=>j[bp(0x1f3)]||[]);return i;},'toStartEndIndexes':function(c,d){const bq=a1,e=c['getRange'](d),f={'startRowIndex':e['getRow']()-0x1,'startColumnIndex':e[bq(0x2f8)]()-0x1};return f[bq(0x1c1)]=e[bq(0x269)]()+f['startRowIndex'],f[bq(0x25f)]=e[bq(0x2ec)]()+f[bq(0x2cf)],f;}},DateUtils={'getSerialNumberDateNoGMT':function(c){return c['getTime']()/0x5265c00+0x63e1;},'getSerialNumberDate':function(c){return(c['getTime']()+0x3*0x3c*0x3c*0x3e8)/0x5265c00+0x63e1;},'getDateFromSerialNumberDate':function(c){return new Date((c-0x63e1)*0x5265c00-0x3*0x3c*0x3c*0x3e8);},'getStrDateFromSerialNumberDate':function(c){const br=a1;return Utilities['formatDate'](new Date((c-0x63e1)*0x5265c00),br(0x307),br(0x276));},'getStrDateTimeFromSerialNumberDate':function(c){const bs=a1;return Utilities['formatDate'](new Date((c-0x63e1)*0x5265c00),bs(0x307),bs(0x300));},'date_from_str':function(c,d='.'){const bt=a1;try{return d1=new Date(...c['split'](d)['reverse']()),d1['setMonth'](d1['getMonth']()-0x1);}catch(f){console['log'](f,bt(0x228),c);}},'convertDateColumnToLocaleDate':function(c,d){return c=c['map'](function(e){const bu=b;return e[d]=new Date(e[d])['toLocaleDateString'](bu(0x1c0)),e;}),c;},'convertDateColumnToUTCDate':function(c,d){const bv=a1;return c=c[bv(0x24a)](function(e){const bw=bv;return e[d]=new Date(e[d])[bw(0x259)](bw(0x1c0)),e;}),c;},'convertDateColumnTo_3hDate':function(c,d){const bx=a1;return c=c[bx(0x24a)](function(e){const by=bx;return e[d]=Utilities['formatDate'](new Date(e[d]),by(0x338),'dd-MM-yyyy'),e;}),c;},'findRowAfterDate':function(c,d){const bz=a1;let e;const f=Math['round'](c);let g=ApiUtils[bz(0x235)](SSId,d,bz(0x27f),bz(0x221));g[bz(0x2e0)]&&(e=g['findLastIndex'](h=>h[0x0]<f));;e===undefined||e===-0x1?e=0x0:e++;;return e;},'findRowDaysBefore':function(c=0x5,d=a1(0x1cd)){const bA=a1;let e;const f=Math['round'](this[bA(0x24d)](new Date()))-c;let g=ApiUtils[bA(0x235)](SSId,d,bA(0x27f),bA(0x221));g[bA(0x2e0)]&&(e=g[bA(0x23a)](h=>h[0x0]<f));;e===undefined||e===-0x1?e=0x0:e++;;return e;},'convertDate':function(c){const bB=a1;return Utilities[bB(0x231)](c,'GMT+03',bB(0x30a));},'generateContinuousPeriodsFast':function(c,d){const bC=a1,e=0x1f-0x1,f=0x5265c00;console[bC(0x25d)](this[bC(0x220)](d));let g=d?this['getDateFromSerialNumberDate'](d):Date[bC(0x2bd)]();g=Math[bC(0x217)](g/f)*f;const h=g-c*f,i=[];let j=h,k=j+e*f;while(j<=g){i[bC(0x1d2)]({'start':l(j),'end':l(Math[bC(0x33c)](k,g))}),j=k,k=j+e*f;}return i;function l(m){const bD=bC;return new Date(m)[bD(0x1cf)]()[bD(0x2fd)](0x0,0xa);}},'formatDateTo_dd_MM_yyyy':function(c){const bE=a1;return c['slice'](0x0,0xa)[bE(0x34f)]('-')[bE(0x1ef)]()[bE(0x1a8)]('.');},'reversDateStToSort':function(c,d='.'){const bF=a1;try{return c[bF(0x34f)](d)[bF(0x1ef)]()[bF(0x1a8)]('');}catch(f){console['log'](f[bF(0x356)],bF(0x228),c);}}},OtherUtils={'getRowIndexDateGteToday':function(c,d,e=0x0,f=![]){const bH=a1;let g=c['map'](k=>{const bG=b;return DateUtils[bG(0x282)](k[d]);});const h=new Date(new Date(new Date()[bH(0x29a)]()-e*0x5265c00)['toDateString']())[bH(0x273)](),i=k=>k<h,j=g[bH(0x23a)](i);return j===-0x1?j:j+0x1;},'_objToArray_':c=>c[a1(0x24a)](d=>Object[a1(0x1f3)](d)),'_objToTitArray_':c=>c['length']?[Object[a1(0x318)](c[0x0])][a1(0x2dd)](_objToArray_(c)):[],'_ruDate_':c=>new Date(c)[a1(0x243)]('ru')[a1(0x2fd)](0x0,0xa),'_range_':(c,d,e)=>[...Array(c)[a1(0x318)]()]['slice'](d,e),'_CSVtoArray_':function(c){const bI=a1;if(c[bI(0x280)]!=bI(0x1b0)){console[bI(0x2fb)](c[bI(0x2fb)]);throw new Error(bI(0x349));}return c=UrlFetchApp[bI(0x1e4)](c['file']),c=c['getContentText'](),Utilities[bI(0x1b7)](c,';');},'getDataFile':function(c){const bJ=a1;let d=UrlFetchApp[bJ(0x1e4)](c);if(c[bJ(0x238)]('.xlsx')>-0x1){let e=d['getBlob'](),f={'title':bJ(0x1e2)+c,'mimeType':MimeType['GOOGLE_SHEETS']};e=Drive[bJ(0x287)]['insert'](f,e),d=SpreadsheetApp[bJ(0x296)](e['getId']()),d=d[bJ(0x254)]()[0x0][bJ(0x359)]()[bJ(0x28f)](),Drive[bJ(0x287)][bJ(0x34e)](e[bJ(0x2ce)]());}else d=d[bJ(0x271)](),d=Utilities['parseCsv'](d,';');return d;}},SysUtils={'pagination':function(c,d){const bK=a1;let e=0x0,f=[];while(e<c[bK(0x2e0)]){f['push'](c['slice'](e,e+d)),e+=d;}return f;},'checkResponseCode':function(c){const bL=a1;if(c===0x191)throw new Error('Ошибка\x20авторизации,\x20проверьте\x20ключ\x20авторизации.');if(c===0x190)throw new Error(bL(0x286));if(c===0x1ad)throw new Error('Превышено\x20допустимое\x20кол-во\x20запросов\x20в\x20единицу\x20времени.\x20Code\x20429');if(c>=0x1f4)throw new Error('Сервер\x20не\x20откликается.\x20Повторите\x20запрос\x20через\x20некоторое\x20время.\x20Code\x20'+c);if(c!==0xc8)throw new Error(bL(0x1b9)+c);return!![];}};function checkAccess_(){const bM=a1,c=ScriptApp['getScriptId']();if(!accessRights[c])throw new Error(bM(0x232));return!![];}function getkey(c=a1(0x2a7)){const bN=a1;let d='',f='';if(c==bN(0x262))rangeName='B2',d=bN(0x2f7);else{if(c==='stand')rangeName='B3',d=bN(0x313);else c==='analytics'?(rangeName='B20',d=bN(0x322)):(rangeName='B1',d=bN(0x2bf));};try{key=SS['getSheetByName'](bN(0x1cb))[bN(0x2d9)](rangeName)[bN(0x2cd)]();}catch(g){f=bN(0x1b4)+g,key='';}return key==''&&(f='Отсутствует\x20ключ\x20доступа:\x20'+d,inform(SS,[f,bN(0x326)])),key;}function getLastDataRow(c,d){const bO=a1;try{let f=c[bO(0x1b2)](),g=0x0;return f>0x0?g=c['getRange'](d+f):g=c['getRange'](d+0x1),g[bO(0x2cd)]()!==''?f:g['getNextDataCell'](SpreadsheetApp['Direction']['UP'])[bO(0x332)]();}catch(h){return console['log'](c[bO(0x2d4)](),'\x20-\x20Col:\x20\x20',d,'\x20-\x20ошибка\x20getLastDataRow:\x20'+h),NaN;}}function inform(c,d=['content',a1(0x34a)],f=![],g=!![],h=!![]){const bP=a1;try{g&&console[bP(0x2a5)](...d),h&&c[bP(0x32f)](...d,0xf),f&&SpreadsheetApp[bP(0x320)]()[bP(0x1c7)](d[0x0]);}catch(i){if(i['message']!==bP(0x2b2))console['log'](i[bP(0x26b)]);}}function removeRowsOverLimitTrigg(c){const bQ=a1;let d,e;if(c){const f=SpreadsheetApp[bQ(0x1b5)](),g=f[bQ(0x212)](c);switch(c){case'Аналитика\x20(api)':d=f[bQ(0x2d9)]('Параметры!B8')[bQ(0x2cd)](),e=bQ(0x246),d=d||0x186a0;break;case bQ(0x222):d=f[bQ(0x2d9)](bQ(0x25c))['getValue'](),e=bQ(0x2b3),d=d||0x1fbd0;break;case bQ(0x337):d=f[bQ(0x2d9)](bQ(0x247))[bQ(0x2cd)](),e=bQ(0x26d),d=d||0x1fbd0;break;}ScriptApp[bQ(0x2a3)]()[bQ(0x31f)](h=>{if(h['getHandlerFunction']()===e)ScriptApp['deleteTrigger'](h);});try{let h=g[bQ(0x359)]()[bQ(0x1b2)]();if(h/d>0x32)throw new Error('Удаление\x20строк\x20прервано.\x20Проверить\x20количество\x20удаляемых\x20строк(lastDataRow:'+h+bQ(0x27e)+d+'>1.5('+h/d+'))');let i=h-d-0x1;if(i>0x0)return g[bQ(0x215)](0x2,i),console[bQ(0x25d)]('Очищено\x20строк:',i),i;}catch(j){console[bQ(0x25d)](bQ(0x33f),j);}}return 0x0;}function cellsCount(c,d=![],e=!![]){const bR=a1,f={'includeGridData':![],'fields':bR(0x289)},g=Sheets['Spreadsheets'][bR(0x352)](c,f);let h={};const i=g[bR(0x2fa)][bR(0x1ea)]((j,k)=>{const bS=bR;let l=k[bS(0x230)][bS(0x2f3)][bS(0x2c5)]*k['properties'][bS(0x2f3)]['rowCount'];return h[k['properties'][bS(0x21d)]]=l,j+l;},0x0);return h=e?Object[bR(0x20a)](h)[bR(0x223)]((j,k)=>k[0x1]-j[0x1]):'',d&&console['log'](bR(0x1ca)+SpreadsheetApp[bR(0x296)](c)[bR(0x2d4)]()+':\x20'+i+'\x0a',h),i;}function removeTriggers(c){const bT=a1;ScriptApp[bT(0x2a3)]()['forEach'](d=>{const bU=bT;let e=d['getHandlerFunction']();c[bU(0x334)](e)&&(ScriptApp[bU(0x1ed)](d),console['log'](bU(0x1bb)+e+'\x22\x20removed'));});}function clearValues(c){const bV=a1;let d=bV(0x29b);ranges=ApiUtils[bV(0x235)](d,bV(0x2e9)),ranges=ranges[bV(0x1ea)]((f,g)=>{const bW=bV;c===g?.[0x0]&&f[bW(0x1d2)](g[0x1]);;return f;},[]);const e=SpreadsheetApp['getActive']();e[bV(0x317)](ranges)[bV(0x303)](),inform(e,[bV(0x1f6)+ranges,bV(0x32e)]);}function saveResult_(c,d){const bX=a1,e=DriveApp['getFoldersByName']('JSON')[bX(0x2c1)](),f=new Date()['toLocaleString']('ru');e[bX(0x1e9)](''+f+d+bX(0x2f1),JSON[bX(0x1d4)](c));}function saveAndReadDataToJSON_(c,d,e=!![],f=a1(0x33a)){const bY=a1,g=j(f);;let h=g['getFilesByName'](d+bY(0x2f1)),i=[];if(h[bY(0x210)]()){let k=h['next']();console['log'](k['getName']()),i=JSON[bY(0x24f)](k['getBlob']()[bY(0x1f5)]()),c=Array[bY(0x249)](c)?i[bY(0x2dd)](c):Object[bY(0x256)](i,c);e?k[bY(0x342)](JSON['stringify'](c)):k['setTrashed'](!![]);;}else e&&g[bY(0x1e9)](d+bY(0x2f1),JSON[bY(0x1d4)](c));return c;function j(l){const bZ=bY;let m;try{m=DriveApp[bZ(0x22f)](l)['next']();}catch(n){m=DriveApp[bZ(0x2ba)](l);};return m;}}function usersTriggerUpdate(){const c0=a1;let c=c0(0x29b),d=ApiUtils[c0(0x235)](c,c0(0x2b7));if(d['length']){const e=SpreadsheetApp[c0(0x1b5)](),f=e[c0(0x2ce)]();d[c0(0x31f)](g=>{const c1=c0;let h;const i=JSON['parse'](g[0x0]);try{if(g[0x1]==='setup'){const {handler:j,atHour:k,everyHours:l}=i;removeTriggers(j);let m=ScriptApp['newTrigger'](j)[c1(0x22e)]();if(k!==undefined)m['everyDays'](0x1)[c1(0x2ab)](k);else l&&m[c1(0x1fd)](l);m[c1(0x263)](),h=c1(0x226)+j+'\x20завершено.';}else{if(g[0x1]==='remove'){const {handlers:n}=i;removeTriggers(n),h='Удаление\x20триггеров\x20'+n+c1(0x1f1);}else{if(g[0x1]===c1(0x1e8)){const {range:o,value:p}=i;ApiUtils[c1(0x28a)](f,p,o),h='Установка\x20параметров\x20в\x20диапазон\x20'+o+'\x20завершена.';}}}}catch(q){h='Ошибка\x20выполнения\x20команды\x20'+g[0x1]+',\x20'+(handler||handlers)+c1(0x327)+i+'.';}inform(e,[h,c1(0x35c)]);});}else console[c0(0x25d)](c0(0x32c));}function include(c){const c2=a1;return HtmlService[c2(0x35d)](c)[c2(0x2d2)]();}function checkAccess_(){const c3=a1,c=c3(0x26e),d=ScriptApp[c3(0x281)](),e={'method':c3(0x266),'contentType':c3(0x27d),'headers':{'Authorization':'Bearer\x20'+d},'muteHttpExceptions':!![]},f=UrlFetchApp[c3(0x1e4)](c,e),g=f[c3(0x271)](),h=f[c3(0x21a)](),i=[0x191,0x193][c3(0x334)](h)||isAuthPage_(g);if(i){inform(SS,['Необходимо\x20авторизоваться:\x20Меню->Авторизация']);throw new Error();}let {isAllowed:j,msg:k}=JSON[c3(0x24f)](g);if(!j){inform(SS,[k,'Внимание:']);throw new Error('Отсутствует\x20доступ\x20к\x20библиотеке.\x20Обратитесь\x20в\x20техподдержку.');}return j;}function isAuthPage_(c){const c4=a1;return c[c4(0x334)](c4(0x293))||c['includes'](c4(0x257));}function checkOAuthMenu_(){checkOAuth_(inf=!![]);}function checkOAuth_(c=![]){const c5=a1,authInfo=ScriptApp[c5(0x1cc)](ScriptApp[c5(0x22b)][c5(0x239)]);if(authInfo['getAuthorizationStatus']()===ScriptApp[c5(0x213)]['NOT_REQUIRED'])c&&inform(SS,[c5(0x312),c5(0x211)]),console[c5(0x25d)](c5(0x21e));else{const d=ScriptApp[c5(0x1cc)](ScriptApp[c5(0x22b)][c5(0x239)])['getAuthorizedScopes']();console[c5(0x25d)](c5(0x343)+d+'\x20not\x20enough.'),inform(SS,[c5(0x1c5),c5(0x211)]),ScriptApp['requireAllScopes'](ScriptApp[c5(0x22b)][c5(0x239)]);}}function b(c,d){const e=a();return b=function(f,g){f=f-0x1a7;let h=e[f];if(b['wAuTuU']===undefined){var i=function(m){const n='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let o='',p='';for(let q=0x0,r,s,t=0x0;s=m['charAt'](t++);~s&&(r=q%0x4?r*0x40+s:s,q++%0x4)?o+=String['fromCharCode'](0xff&r>>(-0x2*q&0x6)):0x0){s=n['indexOf'](s);}for(let u=0x0,v=o['length'];u<v;u++){p+='%'+('00'+o['charCodeAt'](u)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(p);};b['pWdkwt']=i,c=arguments,b['wAuTuU']=!![];}const j=e[0x0],k=f+j,l=c[k];return!l?(h=b['pWdkwt'](h),c[k]=h):h=l,h;},b(c,d);}function getAuthorizationHtml(){const c6=a1;return HtmlService[c6(0x2db)]('authorization')[c6(0x344)]()[c6(0x2d2)]();}function auth(){const c7=a1;SpreadsheetApp[c7(0x320)]()[c7(0x2f2)](HtmlService[c7(0x1d1)](getAuthorizationHtml())[c7(0x233)](0x5a),c7(0x204));}